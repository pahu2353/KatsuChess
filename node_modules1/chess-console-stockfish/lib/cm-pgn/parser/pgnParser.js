"use strict";function peg$subclass(n,r){function t(){this.constructor=n}t.prototype=r.prototype,n.prototype=new t}function peg$SyntaxError(n,r,t,u){this.message=n,this.expected=r,this.found=t,this.location=u,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,peg$SyntaxError)}function peg$parse(n,r){r=void 0!==r?r:{};var t,u={},e={pgn:lt},o=lt,c=function(n,r){var t=r||[];return t.unshift(n),t},l=function(n,r){var t=r||[];return t.unshift(n),t},a=function(){return[[]]},i=function(n){return n},f=function(n){return n},s=function(n,r,t,u,e,o,c,l){var a=l||[],i={turn:"w"};return i.moveNumber=r,i.notation=u,i.commentBefore=t,i.commentAfter=o,i.commentMove=n,i.variations=c||[],i.nag=e||null,a.unshift(i),a},h=function(n,r,t,u,e,o,c,l){var a=l||[],i={turn:"b"};return i.moveNumber=r,i.notation=u,i.commentBefore=t,i.commentAfter=o,i.variations=c||[],a.unshift(i),i.nag=e||null,a},p="1:0",d=nt("1:0",!1),v=function(){return["1:0"]},A="0:1",g=nt("0:1",!1),C=function(){return["0:1"]},$="1-0",x=nt("1-0",!1),m=function(){return["1-0"]},b="0-1",y=nt("0-1",!1),O=function(){return["0-1"]},E="1/2-1/2",w=nt("1/2-1/2",!1),k=function(){return["1/2-1/2"]},S="*",F=nt("*",!1),R=function(){return["*"]},B=/^[^}]/,N=rt(["}"],!0,!1),P=function(n){return n.join("").trim()},j="{",M=nt("{",!1),D="}",K=nt("}",!1),Q=function(n,r,t){var u=r||[];return u.unshift(n),u},T=function(n,r){var t=r||[];return t.unshift(n),t},I="(",U=nt("(",!1),q=")",z=nt(")",!1),G=".",H=nt(".",!1),J=function(n){return n},L=tt("integer"),V=/^[0-9]/,W=rt([["0","9"]],!1,!1),X=function(n){return parseInt(n.join(""),10)},Y=" ",Z=nt(" ",!1),_=function(){return""},nn=function(n,r,t,u,e,o,c){var l={};return l.fig=n||null,l.disc=r||null,l.strike=t||null,l.col=u,l.row=e,l.check=c||null,l.promotion=o,l.notation=(n||"")+(r||"")+(t||"")+u+e+(o||"")+(c||""),l},rn=function(n,r,t,u,e,o,c,l){var a={};return a.fig=n||null,a.strike="x"==u?u:null,a.col=e,a.row=o,a.check=l||null,a.notation=(n&&"P"!==n?n:"")+r+t+("x"==u?u:"-")+e+o+(c||"")+(l||""),a.promotion=c,a},tn=function(n,r,t,u,e,o){var c={};return c.fig=n||null,c.strike=r||null,c.col=t,c.row=u,c.check=o||null,c.notation=(n||"")+(r||"")+t+u+(e||"")+(o||""),c.promotion=e,c},un="O-O-O",en=nt("O-O-O",!1),on=function(n){var r={};return r.notation="O-O-O"+(n||""),r.check=n||null,r},cn="O-O",ln=nt("O-O",!1),an=function(n){var r={};return r.notation="O-O"+(n||""),r.check=n||null,r},fn="+-",sn=nt("+-",!1),hn="+",pn=nt("+",!1),dn=function(n){return n[1]},vn="$$$",An=nt("$$$",!1),gn="#",Cn=nt("#",!1),$n="=",xn=nt("=",!1),mn=function(n){return"="+n},bn=function(n,r){var t=r||[];return t.unshift(n),t},yn="$",On=nt("$",!1),En=function(n){return"$"+n},wn="!!",kn=nt("!!",!1),Sn=function(){return"$3"},Fn="??",Rn=nt("??",!1),Bn=function(){return"$4"},Nn="!?",Pn=nt("!?",!1),jn=function(){return"$5"},Mn="?!",Dn=nt("?!",!1),Kn=function(){return"$6"},Qn="!",Tn=nt("!",!1),In=function(){return"$1"},Un="?",qn=nt("?",!1),zn=function(){return"$2"},Gn="‼",Hn=nt("‼",!1),Jn="⁇",Ln=nt("⁇",!1),Vn="⁉",Wn=nt("⁉",!1),Xn="⁈",Yn=nt("⁈",!1),Zn="□",_n=nt("□",!1),nr=function(){return"$7"},rr=function(){return"$10"},tr="∞",ur=nt("∞",!1),er=function(){return"$13"},or="⩲",cr=nt("⩲",!1),lr=function(){return"$14"},ar="⩱",ir=nt("⩱",!1),fr=function(){return"$15"},sr="±",hr=nt("±",!1),pr=function(){return"$16"},dr="∓",vr=nt("∓",!1),Ar=function(){return"$17"},gr=function(){return"$18"},Cr="-+",$r=nt("-+",!1),xr=function(){return"$19"},mr="⨀",br=nt("⨀",!1),yr=function(){return"$22"},Or="⟳",Er=nt("⟳",!1),wr=function(){return"$32"},kr="→",Sr=nt("→",!1),Fr=function(){return"$36"},Rr="↑",Br=nt("↑",!1),Nr=function(){return"$40"},Pr="⇆",jr=nt("⇆",!1),Mr=function(){return"$132"},Dr="D",Kr=nt("D",!1),Qr=function(){return"$220"},Tr=/^[RNBQKP]/,Ir=rt(["R","N","B","Q","K","P"],!1,!1),Ur=/^[a-h]/,qr=rt([["a","h"]],!1,!1),zr=/^[1-8]/,Gr=rt([["1","8"]],!1,!1),Hr="x",Jr=nt("x",!1),Lr="-",Vr=nt("-",!1),Wr=0,Xr=[{line:1,column:1}],Yr=0,Zr=[],_r=0;if("startRule"in r){if(!(r.startRule in e))throw new Error("Can't start parsing from rule \""+r.startRule+'".');o=e[r.startRule]}function nt(n,r){return{type:"literal",text:n,ignoreCase:r}}function rt(n,r,t){return{type:"class",parts:n,inverted:r,ignoreCase:t}}function tt(n){return{type:"other",description:n}}function ut(r){var t,u=Xr[r];if(u)return u;for(t=r-1;!Xr[t];)t--;for(u={line:(u=Xr[t]).line,column:u.column};t<r;)10===n.charCodeAt(t)?(u.line++,u.column=1):u.column++,t++;return Xr[r]=u,u}function et(n,r){var t=ut(n),u=ut(r);return{start:{offset:n,line:t.line,column:t.column},end:{offset:r,line:u.line,column:u.column}}}function ot(n){Wr<Yr||(Wr>Yr&&(Yr=Wr,Zr=[]),Zr.push(n))}function ct(n,r,t){return new peg$SyntaxError(peg$SyntaxError.buildMessage(n,r),n,r,t)}function lt(){var n,r,t;return n=Wr,(r=function(){var n,r;n=Wr,(r=it())!==u&&(n,r=i(r));return n=r}())!==u?((t=ft())===u&&(t=null),t!==u?(n,n=r=c(r,t)):(Wr=n,n=u)):(Wr=n,n=u),n===u&&(n=Wr,(r=at())!==u?((t=it())===u&&(t=null),t!==u?(n,n=r=l(r,t)):(Wr=n,n=u)):(Wr=n,n=u),n===u&&(n=Wr,(r=At())===u&&(r=null),r!==u&&(n,r=a()),n=r)),n}function at(){var n,r;return n=Wr,(r=ft())!==u&&(n,r=f(r)),n=r}function it(){var r,t,e,o,c,l,a,i,f,h,p,d,v,A,g,C;return r=Wr,(t=At())===u&&(t=null),t!==u?((e=ht())===u&&(e=null),e!==u?((o=At())===u&&(o=null),o!==u?((c=function(){var r,t,e;r=Wr,(t=vt())!==u?(46===n.charCodeAt(Wr)?(e=G,Wr++):(e=u,0===_r&&ot(H)),e===u&&(e=null),e!==u?(r,t=J(t),r=t):(Wr=r,r=u)):(Wr=r,r=u);return r}())===u&&(c=null),c!==u?((l=At())===u&&(l=null),l!==u?((a=ht())===u&&(a=null),a!==u?((i=At())===u&&(i=null),i!==u&&(f=gt())!==u?((h=At())===u&&(h=null),h!==u?((p=xt())===u&&(p=null),p!==u?((d=At())===u&&(d=null),d!==u?((v=ht())===u&&(v=null),v!==u?((A=At())===u&&(A=null),A!==u?((g=function n(){var r,t,e,o,c,l,a;r=Wr;t=pt();t!==u&&(e=it())!==u&&dt()!==u?((o=At())===u&&(o=null),o!==u?((c=n())===u&&(c=null),c!==u?((l=At())===u&&(l=null),l!==u?((a=bt())===u&&(a=null),a!==u?(r,t=Q(e,c,a),r=t):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u);return r}())===u&&(g=null),g!==u?((C=ft())===u&&(C=null),C!==u?(r,r=t=s(e,c,a,f,p,v,g,C)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u),r===u&&(r=st()),r}function ft(){var n,r,t,e,o,c,l,a,i,f,s,p,d,v,A,g;return n=Wr,(r=At())===u&&(r=null),r!==u?((t=ht())===u&&(t=null),t!==u?((e=At())===u&&(e=null),e!==u?((o=bt())===u&&(o=null),o!==u?((c=At())===u&&(c=null),c!==u?((l=ht())===u&&(l=null),l!==u?((a=At())===u&&(a=null),a!==u&&(i=gt())!==u?((f=At())===u&&(f=null),f!==u?((s=xt())===u&&(s=null),s!==u?((p=At())===u&&(p=null),p!==u?((d=ht())===u&&(d=null),d!==u?((v=At())===u&&(v=null),v!==u?((A=function n(){var r,t,e,o,c;r=Wr;t=pt();t!==u&&(e=at())!==u&&dt()!==u?((o=At())===u&&(o=null),o!==u?((c=n())===u&&(c=null),c!==u?(r,t=T(e,c),r=t):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u);return r}())===u&&(A=null),A!==u?((g=it())===u&&(g=null),g!==u?(n,n=r=h(t,o,l,i,s,d,A,g)):(Wr=n,n=u)):(Wr=n,n=u)):(Wr=n,n=u)):(Wr=n,n=u)):(Wr=n,n=u)):(Wr=n,n=u)):(Wr=n,n=u)):(Wr=n,n=u)):(Wr=n,n=u)):(Wr=n,n=u)):(Wr=n,n=u)):(Wr=n,n=u)):(Wr=n,n=u)):(Wr=n,n=u),n===u&&(n=st()),n}function st(){var r,t;return r=Wr,n.substr(Wr,3)===p?(t=p,Wr+=3):(t=u,0===_r&&ot(d)),t!==u&&(r,t=v()),(r=t)===u&&(r=Wr,n.substr(Wr,3)===A?(t=A,Wr+=3):(t=u,0===_r&&ot(g)),t!==u&&(r,t=C()),(r=t)===u&&(r=Wr,n.substr(Wr,3)===$?(t=$,Wr+=3):(t=u,0===_r&&ot(x)),t!==u&&(r,t=m()),(r=t)===u&&(r=Wr,n.substr(Wr,3)===b?(t=b,Wr+=3):(t=u,0===_r&&ot(y)),t!==u&&(r,t=O()),(r=t)===u&&(r=Wr,n.substr(Wr,7)===E?(t=E,Wr+=7):(t=u,0===_r&&ot(w)),t!==u&&(r,t=k()),(r=t)===u&&(r=Wr,42===n.charCodeAt(Wr)?(t=S,Wr++):(t=u,0===_r&&ot(F)),t!==u&&(r,t=R()),r=t))))),r}function ht(){var r,t,e;if(r=Wr,function(){var r;123===n.charCodeAt(Wr)?(r=j,Wr++):(r=u,0===_r&&ot(M));return r}()!==u){for(t=[],B.test(n.charAt(Wr))?(e=n.charAt(Wr),Wr++):(e=u,0===_r&&ot(N));e!==u;)t.push(e),B.test(n.charAt(Wr))?(e=n.charAt(Wr),Wr++):(e=u,0===_r&&ot(N));t!==u&&(e=function(){var r;125===n.charCodeAt(Wr)?(r=D,Wr++):(r=u,0===_r&&ot(K));return r}())!==u?(r,r=P(t)):(Wr=r,r=u)}else Wr=r,r=u;return r}function pt(){var r;return 40===n.charCodeAt(Wr)?(r=I,Wr++):(r=u,0===_r&&ot(U)),r}function dt(){var r;return 41===n.charCodeAt(Wr)?(r=q,Wr++):(r=u,0===_r&&ot(z)),r}function vt(){var r,t,e;if(_r++,r=Wr,t=[],V.test(n.charAt(Wr))?(e=n.charAt(Wr),Wr++):(e=u,0===_r&&ot(W)),e!==u)for(;e!==u;)t.push(e),V.test(n.charAt(Wr))?(e=n.charAt(Wr),Wr++):(e=u,0===_r&&ot(W));else t=u;return t!==u&&(r,t=X(t)),_r--,(r=t)===u&&(t=u,0===_r&&ot(L)),r}function At(){var r,t,e;if(r=Wr,t=[],32===n.charCodeAt(Wr)?(e=Y,Wr++):(e=u,0===_r&&ot(Z)),e!==u)for(;e!==u;)t.push(e),32===n.charCodeAt(Wr)?(e=Y,Wr++):(e=u,0===_r&&ot(Z));else t=u;return t!==u&&(r,t=_()),r=t}function gt(){var r,t,e,o,c,l,a,i,f;return r=Wr,(t=yt())===u&&(t=null),t!==u?(e=Wr,_r++,o=function(){var n,r,t,e,o;n=Wr,(r=mt())!==u?((t=wt())===u&&(t=null),t!==u&&(e=Ot())!==u&&(o=Et())!==u?n=r=[r,t,e,o]:(Wr=n,n=u)):(Wr=n,n=u);return n}(),_r--,o!==u?(Wr=e,e=void 0):e=u,e!==u&&(o=mt())!==u?((c=wt())===u&&(c=null),c!==u&&(l=Ot())!==u&&(a=Et())!==u?((i=$t())===u&&(i=null),i!==u?((f=Ct())===u&&(f=null),f!==u?(r,r=t=nn(t,o,c,l,a,i,f)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u),r===u&&(r=Wr,(t=yt())===u&&(t=null),t!==u&&(e=Ot())!==u&&(o=Et())!==u?((c=function(){var r;120===n.charCodeAt(Wr)?(r=Hr,Wr++):(r=u,0===_r&&ot(Jr));r===u&&(45===n.charCodeAt(Wr)?(r=Lr,Wr++):(r=u,0===_r&&ot(Vr)));return r}())===u&&(c=null),c!==u&&(l=Ot())!==u&&(a=Et())!==u?((i=$t())===u&&(i=null),i!==u?((f=Ct())===u&&(f=null),f!==u?(r,r=t=rn(t,e,o,c,l,a,i,f)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u),r===u&&(r=Wr,(t=yt())===u&&(t=null),t!==u?((e=wt())===u&&(e=null),e!==u&&(o=Ot())!==u&&(c=Et())!==u?((l=$t())===u&&(l=null),l!==u?((a=Ct())===u&&(a=null),a!==u?(r,r=t=tn(t,e,o,c,l,a)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u),r===u&&(r=Wr,n.substr(Wr,5)===un?(t=un,Wr+=5):(t=u,0===_r&&ot(en)),t!==u?((e=Ct())===u&&(e=null),e!==u?(r,r=t=on(e)):(Wr=r,r=u)):(Wr=r,r=u),r===u&&(r=Wr,n.substr(Wr,3)===cn?(t=cn,Wr+=3):(t=u,0===_r&&ot(ln)),t!==u?((e=Ct())===u&&(e=null),e!==u?(r,r=t=an(e)):(Wr=r,r=u)):(Wr=r,r=u))))),r}function Ct(){var r,t,e,o;return r=Wr,t=Wr,e=Wr,_r++,n.substr(Wr,2)===fn?(o=fn,Wr+=2):(o=u,0===_r&&ot(sn)),_r--,o===u?e=void 0:(Wr=e,e=u),e!==u?(43===n.charCodeAt(Wr)?(o=hn,Wr++):(o=u,0===_r&&ot(pn)),o!==u?t=e=[e,o]:(Wr=t,t=u)):(Wr=t,t=u),t!==u&&(r,t=dn(t)),(r=t)===u&&(r=Wr,t=Wr,e=Wr,_r++,n.substr(Wr,3)===vn?(o=vn,Wr+=3):(o=u,0===_r&&ot(An)),_r--,o===u?e=void 0:(Wr=e,e=u),e!==u?(35===n.charCodeAt(Wr)?(o=gn,Wr++):(o=u,0===_r&&ot(Cn)),o!==u?t=e=[e,o]:(Wr=t,t=u)):(Wr=t,t=u),t!==u&&(r,t=dn(t)),r=t),r}function $t(){var r,t,e;return r=Wr,61===n.charCodeAt(Wr)?(t=$n,Wr++):(t=u,0===_r&&ot(xn)),t!==u&&(e=yt())!==u?(r,r=t=mn(e)):(Wr=r,r=u),r}function xt(){var r,t,e,o;return r=Wr,(t=function(){var r,t,e;r=Wr,36===n.charCodeAt(Wr)?(t=yn,Wr++):(t=u,0===_r&&ot(On));t!==u&&(e=vt())!==u?(r,t=En(e),r=t):(Wr=r,r=u);r===u&&(r=Wr,n.substr(Wr,2)===wn?(t=wn,Wr+=2):(t=u,0===_r&&ot(kn)),t!==u&&(r,t=Sn()),(r=t)===u&&(r=Wr,n.substr(Wr,2)===Fn?(t=Fn,Wr+=2):(t=u,0===_r&&ot(Rn)),t!==u&&(r,t=Bn()),(r=t)===u&&(r=Wr,n.substr(Wr,2)===Nn?(t=Nn,Wr+=2):(t=u,0===_r&&ot(Pn)),t!==u&&(r,t=jn()),(r=t)===u&&(r=Wr,n.substr(Wr,2)===Mn?(t=Mn,Wr+=2):(t=u,0===_r&&ot(Dn)),t!==u&&(r,t=Kn()),(r=t)===u&&(r=Wr,33===n.charCodeAt(Wr)?(t=Qn,Wr++):(t=u,0===_r&&ot(Tn)),t!==u&&(r,t=In()),(r=t)===u&&(r=Wr,63===n.charCodeAt(Wr)?(t=Un,Wr++):(t=u,0===_r&&ot(qn)),t!==u&&(r,t=zn()),(r=t)===u&&(r=Wr,8252===n.charCodeAt(Wr)?(t=Gn,Wr++):(t=u,0===_r&&ot(Hn)),t!==u&&(r,t=Sn()),(r=t)===u&&(r=Wr,8263===n.charCodeAt(Wr)?(t=Jn,Wr++):(t=u,0===_r&&ot(Ln)),t!==u&&(r,t=Bn()),(r=t)===u&&(r=Wr,8265===n.charCodeAt(Wr)?(t=Vn,Wr++):(t=u,0===_r&&ot(Wn)),t!==u&&(r,t=jn()),(r=t)===u&&(r=Wr,8264===n.charCodeAt(Wr)?(t=Xn,Wr++):(t=u,0===_r&&ot(Yn)),t!==u&&(r,t=Kn()),(r=t)===u&&(r=Wr,9633===n.charCodeAt(Wr)?(t=Zn,Wr++):(t=u,0===_r&&ot(_n)),t!==u&&(r,t=nr()),(r=t)===u&&(r=Wr,61===n.charCodeAt(Wr)?(t=$n,Wr++):(t=u,0===_r&&ot(xn)),t!==u&&(r,t=rr()),(r=t)===u&&(r=Wr,8734===n.charCodeAt(Wr)?(t=tr,Wr++):(t=u,0===_r&&ot(ur)),t!==u&&(r,t=er()),(r=t)===u&&(r=Wr,10866===n.charCodeAt(Wr)?(t=or,Wr++):(t=u,0===_r&&ot(cr)),t!==u&&(r,t=lr()),(r=t)===u&&(r=Wr,10865===n.charCodeAt(Wr)?(t=ar,Wr++):(t=u,0===_r&&ot(ir)),t!==u&&(r,t=fr()),(r=t)===u&&(r=Wr,177===n.charCodeAt(Wr)?(t=sr,Wr++):(t=u,0===_r&&ot(hr)),t!==u&&(r,t=pr()),(r=t)===u&&(r=Wr,8723===n.charCodeAt(Wr)?(t=dr,Wr++):(t=u,0===_r&&ot(vr)),t!==u&&(r,t=Ar()),(r=t)===u&&(r=Wr,n.substr(Wr,2)===fn?(t=fn,Wr+=2):(t=u,0===_r&&ot(sn)),t!==u&&(r,t=gr()),(r=t)===u&&(r=Wr,n.substr(Wr,2)===Cr?(t=Cr,Wr+=2):(t=u,0===_r&&ot($r)),t!==u&&(r,t=xr()),(r=t)===u&&(r=Wr,10752===n.charCodeAt(Wr)?(t=mr,Wr++):(t=u,0===_r&&ot(br)),t!==u&&(r,t=yr()),(r=t)===u&&(r=Wr,10227===n.charCodeAt(Wr)?(t=Or,Wr++):(t=u,0===_r&&ot(Er)),t!==u&&(r,t=wr()),(r=t)===u&&(r=Wr,8594===n.charCodeAt(Wr)?(t=kr,Wr++):(t=u,0===_r&&ot(Sr)),t!==u&&(r,t=Fr()),(r=t)===u&&(r=Wr,8593===n.charCodeAt(Wr)?(t=Rr,Wr++):(t=u,0===_r&&ot(Br)),t!==u&&(r,t=Nr()),(r=t)===u&&(r=Wr,8646===n.charCodeAt(Wr)?(t=Pr,Wr++):(t=u,0===_r&&ot(jr)),t!==u&&(r,t=Mr()),(r=t)===u&&(r=Wr,68===n.charCodeAt(Wr)?(t=Dr,Wr++):(t=u,0===_r&&ot(Kr)),t!==u&&(r,t=Qr()),r=t)))))))))))))))))))))))));return r}())!==u?((e=At())===u&&(e=null),e!==u?((o=xt())===u&&(o=null),o!==u?(r,r=t=bn(t,o)):(Wr=r,r=u)):(Wr=r,r=u)):(Wr=r,r=u),r}function mt(){var n;return(n=Ot())===u&&(n=Et()),n}function bt(){var r,t,e,o;if(r=Wr,(t=vt())!==u){if(e=[],46===n.charCodeAt(Wr)?(o=G,Wr++):(o=u,0===_r&&ot(H)),o!==u)for(;o!==u;)e.push(o),46===n.charCodeAt(Wr)?(o=G,Wr++):(o=u,0===_r&&ot(H));else e=u;e!==u?(r,r=t=J(t)):(Wr=r,r=u)}else Wr=r,r=u;return r}function yt(){var r;return Tr.test(n.charAt(Wr))?(r=n.charAt(Wr),Wr++):(r=u,0===_r&&ot(Ir)),r}function Ot(){var r;return Ur.test(n.charAt(Wr))?(r=n.charAt(Wr),Wr++):(r=u,0===_r&&ot(qr)),r}function Et(){var r;return zr.test(n.charAt(Wr))?(r=n.charAt(Wr),Wr++):(r=u,0===_r&&ot(Gr)),r}function wt(){var r;return 120===n.charCodeAt(Wr)?(r=Hr,Wr++):(r=u,0===_r&&ot(Jr)),r}if((t=o())!==u&&Wr===n.length)return t;throw t!==u&&Wr<n.length&&ot({type:"end"}),ct(Zr,Yr<n.length?n.charAt(Yr):null,Yr<n.length?et(Yr,Yr+1):et(Yr,Yr))}peg$subclass(peg$SyntaxError,Error),peg$SyntaxError.buildMessage=function(n,r){var t={literal:function(n){return'"'+e(n.text)+'"'},class:function(n){var r,t="";for(r=0;r<n.parts.length;r++)t+=n.parts[r]instanceof Array?o(n.parts[r][0])+"-"+o(n.parts[r][1]):o(n.parts[r]);return"["+(n.inverted?"^":"")+t+"]"},any:function(n){return"any character"},end:function(n){return"end of input"},other:function(n){return n.description}};function u(n){return n.charCodeAt(0).toString(16).toUpperCase()}function e(n){return n.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(n){return"\\x0"+u(n)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(n){return"\\x"+u(n)})}function o(n){return n.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(n){return"\\x0"+u(n)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(n){return"\\x"+u(n)})}return"Expected "+function(n){var r,u,e,o=new Array(n.length);for(r=0;r<n.length;r++)o[r]=(e=n[r],t[e.type](e));if(o.sort(),o.length>0){for(r=1,u=1;r<o.length;r++)o[r-1]!==o[r]&&(o[u]=o[r],u++);o.length=u}switch(o.length){case 1:return o[0];case 2:return o[0]+" or "+o[1];default:return o.slice(0,-1).join(", ")+", or "+o[o.length-1]}}(n)+" but "+function(n){return n?'"'+e(n)+'"':"end of input"}(r)+" found."};export class pgnParser{static parse(n,r){return peg$parse(n,r)}}